# 正则表达式

杂记版

匹配字面量

任何不包含如下这些字符的正则表达式都可以简单地匹配其自身：$()*+.?[\^{|

特别应该注意的是在元字符中并不包含右方括号］、连字号-和右花括号}。前两个符号只有在它们位于一个没有转义的[之后才成为元字符，而}只有在一个没有转义的{之后才是元字符。在任何时候都没有必要对}进行转义。

对任意其他非字母数字的字符进行转义不会改变你的正则表达式的匹配结果——至少在本书中讲到的所有流派中都不会改变。而对一个字母数字字符进行转义则会给它一个特殊含义，或者出现一个语法错误。

块转义

![image-20220315215456524](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315215456524.png)

Perl、PCRE和Java支持使用正则表达式记号‹\Q›和‹\E›。‹\Q›可以消除包括反斜杠在内的所有元字符的特殊含义，直到出现‹\E›为止。如果漏掉了‹\E›，那么在‹\Q›之后直到正则表达式结束之前的所有字符都会被当作字面文本来对待。使用‹\Q...\E›的唯一好处是它读起来会比‹...›更容易一些。

可以在正则表达式之内通过使用‹(?i)›模式修饰符（mode modifier）来设置，如‹(?i) regex›。这个选项可以在.NET、Java、PCRE、Perl、Python和Ruby流派中使用。也可以在JavaScript XRegExp库中使用。

![image-20220315215550284](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315215550284.png)

.NET、Java、PCRE、Perl和Ruby支持局部模式修饰符，这样它只会影响到正则表达式的一部分。例如，‹sensitive(?i)caseless(?-i)sensitive›会匹配sensitiveCASELESS sensitive，但是不能匹配SENSITIVEcaselessSENSITIVE。在正则表达式中‹(?i)›后面的字符不区分大小写，而‹(?-i)›后面的字符重新区分大小写。它们结合在一起就可以像开关一样来使用。



匹配一个包含下列ASCII控制字符的字符串：振铃符（bell）、转义符（escape）、换页符（form feed）、换行符（line feed）、回车符（carriagereturn）、水平制表符（horizontal tab）和垂直制表符（vertical tab）。这些字符的十六进制ASCII编码分别是07、1B、0C、0A、0D、09、0B。

![image-20220315215615901](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315215615901.png)

在Perl 5.10及以后版本和PCRE 7.2及以后版本中，‹\v›的确匹配垂直制表符。不过在这些流派中‹\v›实际上匹配所有垂直空白，包括垂直制表符、换行符以及Unicode行和段落分隔符。因此，对于Perl和PCRE需要使用其他字符表示垂直制表符。JavsScript不支持‹\a›和‹\e›。我们需要其他的办法。这些控制字符以及在下面的小节中会给出的替代语法，均可以在正则表达式中的字符组之内和之外同等地使用。

ASCII码表见附录

![image-20220315215631604](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315215631604.png)



26个控制字符

使用从‹\cA›到‹\cZ›，可以匹配在ASCII表中占据了第1～26位的26个控制字符。其中的c必须是小写的。在大多数流派中，c之后的字母是不区分大小写的。我们推荐始终使用大写字母，因为Java这样要求。

Python和Ruby 1.8中的经典Ruby引擎并不支持这种语法。而Ruby 1.9中的Oniguruma引擎则支持这种语法。

在ASCII表中第27位的转义控制字符就超出了英语字母表的范围，因此我们会在正则表达式中使用‹\x1B›来表示它。

7位字符集

![image-20220315220113928](C:\Users\xueshaoyu_izjm\AppData\Roaming\Typora\typora-user-images\image-20220315220113928.png)



一个小写的\x后跟两个大写十六进制数字可以匹配ASCII字符集中的一个字符。下图给出了在完整ASCII字符集中从‹\x00›到‹\x7F›组合所匹配的每个字符。在该图中，第一个十六进制数字从左边向下排列，而第二个数字则在第一行从左向右排列。



![image-20220315220143592](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315220143592.png)

从‹\x80›到‹\xFF›会匹配哪些字符则要取决于你的正则引擎会如何解释它们，以及你的目标文本使用哪种代码页编码。我们推荐你不要使用‹\x80›到‹\xFF›。作为替代，应该使用在之后介绍的Unicode码位记号。

### 匹配多个字符之一

创建一个正则表达式来匹配calendar的所有常见的错误拼写形式，使你能够在一份文档中找到这个单词而无需依赖作者的拼写能力。

![image-20220315221319109](https://edu-xsy.oss-cn-beijing.aliyuncs.com//img/typora-picgo/image-20220315221319109.png)

使用方括号的表示法被称作是一个字符组（character class）。一个字符组匹配在一个可能的字符列表中的单个字符。

在一个字符组中，只有4个字符拥有特殊功能：\、^、-和]。如果你使用的是Java或者 .NET，那么左方括号[在字符组中也是一个元字符。反斜杠总是会对紧跟其后的字符进行转义，这与它在字符组之外的作用一样。被转义的字符可以是单个字符，也可以是表示某个范围的开始或结束。另外4个元字符只有当它们被放置到特定位置时才拥有特殊含义。如果不放置在具有特殊含义的位置，那么可以不必在字符组中进行转义，直接把它们作为字面字符来使用。例如，

```
‹[][^-]›
```

就可以在本书中除JavaScript以外所有流派中实现此用法。JavaScript将‹[]›视为空字符组，所以任何情况下都无法匹配。虽然如此，我们还是推荐你始终对这些元字符进行转义，因此前面的正则表达式应该始终使用‹[][\^-]›形式。在使用中始终对元字符进行转义会使你的正则表达式更加容易让人理解。

所有其他字符均为字面量，并且可以直接添加到字符组中。正则表达式‹[$()*+.?{|}›匹配方括号中9个字符中的任意一个。这9个字符仅在字符组外有特殊含义。字符组内它们仅视为字面文本。将它们转义只会使正则表达式更加难以阅读。

字母数字字符则不能使用反斜杠来转义。如果这样，要么会出现一个错误，要么会创建一个正则表达式记号（也就是在正则表达式中含有特殊含义的语法符号）。在前面的不可打印字符中，我们讨论了一些其他正则表达式记号，其中提到了它们可以在字符组内使用。所有这些记号都由反斜杠和一个字母组成，有时候后面还会跟一些其他字符。因此，‹[\r\n]›会匹配一个回车符（\r）或者换行符（\n）。



如果紧跟着左括号后面是一个脱字符（^）的话，那么就会排除整个字符组。也就是说它会匹配该字符组以外的任意字符。

> java语言，不包含换行符的排除型字符组会匹配换行符。请确保你的正则表达式不会无意中匹配多行文本。

连字符（-）被放到两个字符之间的时候就会创建一个范围（range）。该范围包含连字符之前的字符、连字符之后的字符，以及按照字母表顺序位于这两个字符之间的所有字符。要想知道一个范围中到底包含了哪些字符，请查看ASCII或者Unicode字符表。‹[A-z]›包含在ASCII表中大写A到小写z之间的所有字符。注意这个范围中会包含一些标点符号，因此可以使用‹[A-Z[\\\]\^_`a-z]›来更加清晰地匹配相同的字符集合。我们推荐你所创建的范围只位于两个数字，或者两个同是大写或者小写的字母之间。

> 反向的范围，如‹[z-a]›，是不允许的。

















# 附录  ASCII码表

| Bin(二进制) | Oct(八进制) | Dec(十进制) | Hex(十六进制) | 缩写/字符                   | 解释         |
| ----------- | ----------- | ----------- | ------------- | --------------------------- | ------------ |
| 0000 0000   | 00          | 0           | 0x00          | NUL(null)                   | 空字符       |
| 0000 0001   | 01          | 1           | 0x01          | SOH(start of headline)      | 标题开始     |
| 0000 0010   | 02          | 2           | 0x02          | STX (start of text)         | 正文开始     |
| 0000 0011   | 03          | 3           | 0x03          | ETX (end of text)           | 正文结束     |
| 0000 0100   | 04          | 4           | 0x04          | EOT (end of transmission)   | 传输结束     |
| 0000 0101   | 05          | 5           | 0x05          | ENQ (enquiry)               | 请求         |
| 0000 0110   | 06          | 6           | 0x06          | ACK (acknowledge)           | 收到通知     |
| 0000 0111   | 07          | 7           | 0x07          | BEL (bell)                  | 响铃         |
| 0000 1000   | 010         | 8           | 0x08          | BS (backspace)              | 退格         |
| 0000 1001   | 011         | 9           | 0x09          | HT (horizontal tab)         | 水平制表符   |
| 0000 1010   | 012         | 10          | 0x0A          | LF (NL line feed, new line) | 换行键       |
| 0000 1011   | 013         | 11          | 0x0B          | VT (vertical tab)           | 垂直制表符   |
| 0000 1100   | 014         | 12          | 0x0C          | FF (NP form feed, new page) | 换页键       |
| 0000 1101   | 015         | 13          | 0x0D          | CR (carriage return)        | 回车键       |
| 0000 1110   | 016         | 14          | 0x0E          | SO (shift out)              | 不用切换     |
| 0000 1111   | 017         | 15          | 0x0F          | SI (shift in)               | 启用切换     |
| 0001 0000   | 020         | 16          | 0x10          | DLE (data link escape)      | 数据链路转义 |
| 0001 0001   | 021         | 17          | 0x11          | DC1 (device control 1)      | 设备控制1    |
| 0001 0010   | 022         | 18          | 0x12          | DC2 (device control 2)      | 设备控制2    |
| 0001 0011   | 023         | 19          | 0x13          | DC3 (device control 3)      | 设备控制3    |
| 0001 0100   | 024         | 20          | 0x14          | DC4 (device control 4)      | 设备控制4    |
| 0001 0101   | 025         | 21          | 0x15          | NAK (negative acknowledge)  | 拒绝接收     |
| 0001 0110   | 026         | 22          | 0x16          | SYN (synchronous idle)      | 同步空闲     |
| 0001 0111   | 027         | 23          | 0x17          | ETB (end of trans. block)   | 结束传输块   |
| 0001 1000   | 030         | 24          | 0x18          | CAN (cancel)                | 取消         |
| 0001 1001   | 031         | 25          | 0x19          | EM (end of medium)          | 媒介结束     |
| 0001 1010   | 032         | 26          | 0x1A          | SUB (substitute)            | 代替         |
| 0001 1011   | 033         | 27          | 0x1B          | ESC (escape)                | 换码(溢出)   |
| 0001 1100   | 034         | 28          | 0x1C          | FS (file separator)         | 文件分隔符   |
| 0001 1101   | 035         | 29          | 0x1D          | GS (group separator)        | 分组符       |
| 0001 1110   | 036         | 30          | 0x1E          | RS (record separator)       | 记录分隔符   |
| 0001 1111   | 037         | 31          | 0x1F          | US (unit separator)         | 单元分隔符   |
| 0010 0000   | 040         | 32          | 0x20          | (space)                     | 空格         |
| 0010 0001   | 041         | 33          | 0x21          | !                           | 叹号         |
| 0010 0010   | 042         | 34          | 0x22          | "                           | 双引号       |
| 0010 0011   | 043         | 35          | 0x23          | #                           | 井号         |
| 0010 0100   | 044         | 36          | 0x24          | $                           | 美元符       |
| 0010 0101   | 045         | 37          | 0x25          | %                           | 百分号       |
| 0010 0110   | 046         | 38          | 0x26          | &                           | 和号         |
| 0010 0111   | 047         | 39          | 0x27          | '                           | 闭单引号     |
| 0010 1000   | 050         | 40          | 0x28          | (                           | 开括号       |
| 0010 1001   | 051         | 41          | 0x29          | )                           | 闭括号       |
| 0010 1010   | 052         | 42          | 0x2A          | *                           | 星号         |
| 0010 1011   | 053         | 43          | 0x2B          | +                           | 加号         |
| 0010 1100   | 054         | 44          | 0x2C          | ,                           | 逗号         |
| 0010 1101   | 055         | 45          | 0x2D          | -                           | 减号/破折号  |
| 0010 1110   | 056         | 46          | 0x2E          | .                           | 句号         |
| 0010 1111   | 057         | 47          | 0x2F          | /                           | 斜杠         |
| 0011 0000   | 060         | 48          | 0x30          | 0                           | 字符0        |
| 0011 0001   | 061         | 49          | 0x31          | 1                           | 字符1        |
| 0011 0010   | 062         | 50          | 0x32          | 2                           | 字符2        |
| 0011 0011   | 063         | 51          | 0x33          | 3                           | 字符3        |
| 0011 0100   | 064         | 52          | 0x34          | 4                           | 字符4        |
| 0011 0101   | 065         | 53          | 0x35          | 5                           | 字符5        |
| 0011 0110   | 066         | 54          | 0x36          | 6                           | 字符6        |
| 0011 0111   | 067         | 55          | 0x37          | 7                           | 字符7        |
| 0011 1000   | 070         | 56          | 0x38          | 8                           | 字符8        |
| 0011 1001   | 071         | 57          | 0x39          | 9                           | 字符9        |
| 0011 1010   | 072         | 58          | 0x3A          | :                           | 冒号         |
| 0011 1011   | 073         | 59          | 0x3B          | ;                           | 分号         |
| 0011 1100   | 074         | 60          | 0x3C          | <                           | 小于         |
| 0011 1101   | 075         | 61          | 0x3D          | =                           | 等号         |
| 0011 1110   | 076         | 62          | 0x3E          | >                           | 大于         |
| 0011 1111   | 077         | 63          | 0x3F          | ?                           | 问号         |
| 0100 0000   | 0100        | 64          | 0x40          | @                           | 电子邮件符号 |
| 0100 0001   | 0101        | 65          | 0x41          | A                           | 大写字母A    |
| 0100 0010   | 0102        | 66          | 0x42          | B                           | 大写字母B    |
| 0100 0011   | 0103        | 67          | 0x43          | C                           | 大写字母C    |
| 0100 0100   | 0104        | 68          | 0x44          | D                           | 大写字母D    |
| 0100 0101   | 0105        | 69          | 0x45          | E                           | 大写字母E    |
| 0100 0110   | 0106        | 70          | 0x46          | F                           | 大写字母F    |
| 0100 0111   | 0107        | 71          | 0x47          | G                           | 大写字母G    |
| 0100 1000   | 0110        | 72          | 0x48          | H                           | 大写字母H    |
| 0100 1001   | 0111        | 73          | 0x49          | I                           | 大写字母I    |
| 01001010    | 0112        | 74          | 0x4A          | J                           | 大写字母J    |
| 0100 1011   | 0113        | 75          | 0x4B          | K                           | 大写字母K    |
| 0100 1100   | 0114        | 76          | 0x4C          | L                           | 大写字母L    |
| 0100 1101   | 0115        | 77          | 0x4D          | M                           | 大写字母M    |
| 0100 1110   | 0116        | 78          | 0x4E          | N                           | 大写字母N    |
| 0100 1111   | 0117        | 79          | 0x4F          | O                           | 大写字母O    |
| 0101 0000   | 0120        | 80          | 0x50          | P                           | 大写字母P    |
| 0101 0001   | 0121        | 81          | 0x51          | Q                           | 大写字母Q    |
| 0101 0010   | 0122        | 82          | 0x52          | R                           | 大写字母R    |
| 0101 0011   | 0123        | 83          | 0x53          | S                           | 大写字母S    |
| 0101 0100   | 0124        | 84          | 0x54          | T                           | 大写字母T    |
| 0101 0101   | 0125        | 85          | 0x55          | U                           | 大写字母U    |
| 0101 0110   | 0126        | 86          | 0x56          | V                           | 大写字母V    |
| 0101 0111   | 0127        | 87          | 0x57          | W                           | 大写字母W    |
| 0101 1000   | 0130        | 88          | 0x58          | X                           | 大写字母X    |
| 0101 1001   | 0131        | 89          | 0x59          | Y                           | 大写字母Y    |
| 0101 1010   | 0132        | 90          | 0x5A          | Z                           | 大写字母Z    |
| 0101 1011   | 0133        | 91          | 0x5B          | [                           | 开方括号     |
| 0101 1100   | 0134        | 92          | 0x5C          | \                           | 反斜杠       |
| 0101 1101   | 0135        | 93          | 0x5D          | ]                           | 闭方括号     |
| 0101 1110   | 0136        | 94          | 0x5E          | ^                           | 脱字符       |
| 0101 1111   | 0137        | 95          | 0x5F          | _                           | 下划线       |
| 0110 0000   | 0140        | 96          | 0x60          | `                           | 开单引号     |
| 0110 0001   | 0141        | 97          | 0x61          | a                           | 小写字母a    |
| 0110 0010   | 0142        | 98          | 0x62          | b                           | 小写字母b    |
| 0110 0011   | 0143        | 99          | 0x63          | c                           | 小写字母c    |
| 0110 0100   | 0144        | 100         | 0x64          | d                           | 小写字母d    |
| 0110 0101   | 0145        | 101         | 0x65          | e                           | 小写字母e    |
| 0110 0110   | 0146        | 102         | 0x66          | f                           | 小写字母f    |
| 0110 0111   | 0147        | 103         | 0x67          | g                           | 小写字母g    |
| 0110 1000   | 0150        | 104         | 0x68          | h                           | 小写字母h    |
| 0110 1001   | 0151        | 105         | 0x69          | i                           | 小写字母i    |
| 0110 1010   | 0152        | 106         | 0x6A          | j                           | 小写字母j    |
| 0110 1011   | 0153        | 107         | 0x6B          | k                           | 小写字母k    |
| 0110 1100   | 0154        | 108         | 0x6C          | l                           | 小写字母l    |
| 0110 1101   | 0155        | 109         | 0x6D          | m                           | 小写字母m    |
| 0110 1110   | 0156        | 110         | 0x6E          | n                           | 小写字母n    |
| 0110 1111   | 0157        | 111         | 0x6F          | o                           | 小写字母o    |
| 0111 0000   | 0160        | 112         | 0x70          | p                           | 小写字母p    |
| 0111 0001   | 0161        | 113         | 0x71          | q                           | 小写字母q    |
| 0111 0010   | 0162        | 114         | 0x72          | r                           | 小写字母r    |
| 0111 0011   | 0163        | 115         | 0x73          | s                           | 小写字母s    |
| 0111 0100   | 0164        | 116         | 0x74          | t                           | 小写字母t    |
| 0111 0101   | 0165        | 117         | 0x75          | u                           | 小写字母u    |
| 0111 0110   | 0166        | 118         | 0x76          | v                           | 小写字母v    |
| 0111 0111   | 0167        | 119         | 0x77          | w                           | 小写字母w    |
| 0111 1000   | 0170        | 120         | 0x78          | x                           | 小写字母x    |
| 0111 1001   | 0171        | 121         | 0x79          | y                           | 小写字母y    |
| 0111 1010   | 0172        | 122         | 0x7A          | z                           | 小写字母z    |
| 0111 1011   | 0173        | 123         | 0x7B          | {                           | 开花括号     |
| 0111 1100   | 0174        | 124         | 0x7C          | \|                          | 垂线         |
| 0111 1101   | 0175        | 125         | 0x7D          | }                           | 闭花括号     |
| 0111 1110   | 0176        | 126         | 0x7E          | ~                           | 波浪号       |
| 0111 1111   | 0177        | 127         | 0x7F          | DEL (delete)                | 删除         |